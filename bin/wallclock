#!/usr/bin/env perl
use warnings;
use strict;
use POSIX qw(strftime ceil);
use Time::HiRes qw(gettimeofday);
use Getopt::Long;
STDOUT->autoflush(1);
Getopt::Long::Configure(
while (1) {
    my ($sec, $usec) = gettimeofday();
    my $frac = 1 - $usec / 1_000_000;
    if ($frac < 0.01) {
        $frac += 1.0;
    }
    select(undef, undef, undef, $frac);
    my $time = localtime();
    printf("%s\n", $time);
}
