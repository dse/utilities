#!/usr/bin/env bash
set -o errexit
set -o pipefail
set -o nounset
shopt -s lastpipe

find "$@" \
     \! \( -type d -name .git -prune \) \
     \! \( -type d -name node_modules -prune \) \
     -type f -name package.json -exec jq -r '.dependencies,.devDependencies|select(. != null)|keys|.[]' {} + | sort | uniq -c | sort -rn
